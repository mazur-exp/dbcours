<%
  last_msg = conversation.last_message
  user = conversation.user
%>

<div
  class="<%= active ? 'bg-blue-50 border-l-4 border-blue-500' : 'hover:bg-gray-50 border-l-4 border-transparent' %> cursor-pointer transition-colors"
  data-conversation-id="<%= conversation.id %>"
  data-action="click->messenger#selectConversation"
>
  <div class="p-4">
    <div class="flex items-start gap-3">
      <!-- –ê–≤–∞—Ç–∞—Ä–∫–∞ -->
      <%= user_avatar_or_initials(user, css_classes: "flex-shrink-0", size_classes: "w-12 h-12") %>

      <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ -->
      <div class="flex-1 min-w-0">
        <div class="flex items-center justify-between mb-1">
          <h4 class="font-semibold text-gray-900 truncate"><%= user.full_name %></h4>
          <% if last_msg %>
            <span class="text-xs text-gray-500 flex-shrink-0 ml-2">
              <%= time_ago_in_words(last_msg.created_at) %> –Ω–∞–∑–∞–¥
            </span>
          <% end %>
        </div>

        <% if last_msg %>
          <p class="text-sm text-gray-600 truncate">
            <%= last_msg.outgoing? ? 'üì§ –í—ã: ' : '' %><%= last_msg.body %>
          </p>
        <% else %>
          <p class="text-sm text-gray-400 italic">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</p>
        <% end %>

        <% if conversation.unread_count > 0 %>
          <span class="inline-block mt-2 px-2 py-0.5 bg-blue-500 text-white text-xs font-bold rounded-full">
            <%= conversation.unread_count %>
          </span>
        <% end %>
      </div>
    </div>
  </div>
</div>
