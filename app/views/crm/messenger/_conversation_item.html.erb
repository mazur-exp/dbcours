<%
  last_msg = conversation.last_message
  user = conversation.user
%>

<div
  class="<%= active ? 'bg-blue-50 border-l-4 border-blue-500' : 'hover:bg-gray-50 active:bg-gray-100 border-l-4 border-transparent' %> cursor-pointer transition-colors touch-manipulation"
  data-conversation-id="<%= conversation.id %>"
  data-action="click->messenger#selectConversation"
>
  <!-- –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π padding –¥–ª—è touch-—É—Å—Ç—Ä–æ–π—Å—Ç–≤: p-5 –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö, p-4 –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ -->
  <div class="p-5 md:p-4 min-h-[72px]">
    <div class="flex items-start gap-3 md:gap-3">
      <!-- –ê–≤–∞—Ç–∞—Ä–∫–∞ - —É–≤–µ–ª–∏—á–µ–Ω–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö -->
      <%= user_avatar_or_initials(user, css_classes: "flex-shrink-0", size_classes: "w-14 h-14 md:w-12 md:h-12") %>

      <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ -->
      <div class="flex-1 min-w-0">
        <div class="flex items-center justify-between mb-1">
          <h4 class="font-semibold text-base md:text-base text-gray-900 truncate"><%= user.full_name %></h4>
          <% if last_msg %>
            <span class="text-xs md:text-xs text-gray-500 flex-shrink-0 ml-2">
              <%= time_ago_in_words(last_msg.created_at) %> –Ω–∞–∑–∞–¥
            </span>
          <% end %>
        </div>

        <% if last_msg %>
          <p class="text-sm md:text-sm text-gray-600 truncate leading-relaxed">
            <%= last_msg.outgoing? ? 'üì§ –í—ã: ' : '' %><%= last_msg.body %>
          </p>
        <% else %>
          <p class="text-sm md:text-sm text-gray-400 italic">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</p>
        <% end %>

        <% if conversation.unread_count > 0 %>
          <span class="inline-block mt-2 px-2.5 py-1 md:px-2 md:py-0.5 bg-blue-500 text-white text-xs font-bold rounded-full">
            <%= conversation.unread_count %>
          </span>
        <% end %>
      </div>
    </div>
  </div>
</div>
